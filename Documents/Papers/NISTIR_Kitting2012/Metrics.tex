As described in the previous section, test methods are being developed that
will be suitable for comparing the performance of different kitting
planning systems. The methods look at plans that are an ordered sequence
of actions for a robot to perform. The actions are specified in terms of
the canonical robot command language (CRCL).

\begin{flushleft}
	\begin{figure}[ht]
		\fbox{
			\begin{minipage}{3.2in}
				\sf
				\begin{tabbing}
					xxx\=xx\=xx\=\kill
					InitCanon()\\	
					SetLengthUnits("meter")\\
					CloseGripper()\\
					CloseToolChanger()\\
					Dwell(1.7)\\
					Message("This message is false")\\
					SetRelativeSpeed(50.0)\\
					SetAbsoluteSpeed(3.8)\\
					MoveThroughTo(\{\{\{5,0,2\}, \{0,0,1\}, \{1,0,0\}\},\\
					\>\{\{5,8,2\}, \{0,0,1\}, \{1,0,0\}\},\\
					\>\{\{7,8,2\}, \{0,0,1\}, \{1,0,0\}\}\}, 3)\\
					MoveStraightTo(\{\{4,8,2\}, \{0,0,1\}, \{1,0,0\}\})\\
					MoveTo(\{\{9,8,2\}, \{0,0,1\}, \{1,0,0\}\})\\
					OpenGripper()\\
					OpenToolChanger()\\
					SetAbsoluteAcceleration(0.95)\\
					SetAngleUnits("degree")\\
					SetEndAngleTolerance(1.3)\\
					SetEndPointTolerance(0.4)\\
					SetIntermediatePointTolerance(10.734)\\
					SetLengthUnits("mm")\\
					SetRelativeAcceleration(0.8)\\
					SetRelativeSpeed(0.75)\\
					SetRelativeAcceleration(-110)\\
					MoveStraightTo(87)\\
					EndCanon(2)\\
				\end{tabbing}
				\rm
			\end{minipage}
		}
		\caption{Kitting Plan for Testing}
		\label{fig:KittingPlan}
	\end{figure}
\end{flushleft}

A sample plan file is shown in Figure~\ref{fig:KittingPlan}. The file is
designed for exercising the kittingViewer which is described in Section \ref{sect:KittingViewer}
and is not intended to make sense
as a plan. It includes a few intentional errors.

Metrics are being developed that will test both the static performance of the planning system
(i.e. end-to-end performance of a single plan without feedback or changes) as well as the
execution performance of the system (i.e. the system is allowed to replan due to changes
in the environment or action failures). The current metrics were developed with
kitting specifically in mind. However, it is envisioned that we will eventually have
a taxonomy of metrics where high-level metrics build upon lower level metrics and
branches of the taxonomy may be applicable across multiple domains.

\subsection{Static Kitting Viewer Metrics}
\begin{figure}[ht!]
		\begin{center}
			\includegraphics[width=3.1in]{images/MetricTaxonomy.jpg}
			%\include{MetricTaxonomy}}
		\end{center}

	\caption{Kitting static metric taxonomy with abbreviations defined below}
	\label{fig:StaticMetricTax}
\end{figure}

The current metric taxonomy is shown in Figure~\ref{fig:StaticMetricTax} and is
described below. The metrics are designed to be evaluated at the end of each
CRCL command with cumulative values.

\begin{itemize}

\item \sf Action Commands Executed (ACE) \rm -- the number of action commands that
  have been executed so far. An action command is any command that takes
  time to execute.\\

\item \sf Other Commands Executed (OCE) \rm -- the number of commands that are
  not action commands that have been executed so far -- mostly setting
  commands. Executing these commands is assumed to take a negligible amount
  of time.\\
   
 \item \sf Total Commands Executed (TCE) \rm -- the sum of ACE and OCE.\\

\item \sf Total Distance Moved (TDM) \rm -- the total distance that the
  tool tip has moved.  This is calculated as the total of the distances between 
  points in
  the move commands, taken in order (and starting at the place where the
  controlled point is located initially). The value is updated as each point
  is reached, not continuously.\\
  
 \item \sf Current Command Execution Time (CCET) \rm -- the time that the current
   command took to execute.\\
   
\item \sf Total Execution Time (TET) \rm -- the total time taken so far by
  executing action commands. This does not include any time that may elapse
  between when one command finishes execution and when the user tells the
  system to execute another command. The total execution time is
  meant to be very close to the actual amount of time that would be taken
  by the system without user intervention.\\

\item \sf Range Errors (RE) \rm -- the number of times a command tries to set a
  a parameter to a value that is out of the allowed range of the parameter.\\

\item \sf Parse Errors  (PE) \rm -- the number of lines in the CRCL command file
  that cause an error in the command file parser. \\

\item \sf Command Sequence Errors (CSE) \rm -- the number of commands that are
  out of sequence. An InitCanon command is out of sequence if it is not the
  first command in the file. An EndCanon command is out of sequence if it
  is not the last command in the file. Other commands are out of sequence
  if they occur before InitCanon or after EndCanon.\\

\item \sf Total Errors (TE) \rm -- the sum of the range errors, parse errors,
  and command sequence errors.\\

\item \sf Useless Command Executed (UCE) \rm -- the number of commands that do
  not change the state of the workstation. Such commands have no effect, so
  they are useless. The \sf CloseGripper() \rm and \sf CloseToolChanger()
  \rm commands in Figure~\ref{fig:KittingPlan} are useless because the
  gripper and tool changer are closed in the initial conditions.\\
  
\item \sf Number of Objects Moved Correctly (NOMC) \rm -- the number of objects
  that were moved correctly from the parts supply to the kit.\\

\item \sf Number of Objects Moved Incorrectly (NOMI) \rm -- the number of objects
  that were moved to an incorrect position in the kit.\\
  
\item \sf Number of Total Objects Moved (NTOM) \rm -- the sum of NOMC and NOMI.\\

\item \sf Incorrect Gripper (IG) \rm -- the wrong gripper was used to pick up an object.\\

\item \sf Joint Out of Range (JOR) \rm -- a joint of the robot was commanded to 
  move to an out-of-limit position.\\

\item \sf Weight Violation (WV) \rm -- the robot was asked to move some object that
  violates its load capacity.\\
  
\item \sf Outside Work Volume (OWV) \rm -- the robot was asked to move outside its
  work volume.\\
  
\item \sf Constraint Violations (CV) \rm -- the total of IG, JOR, WV and OWV.

\end{itemize}

\subsection{Execution Metrics for Kit Building}
During execution, automated kitting fails to reach its full potential when the supply chain fails and parts and components are not available for kit construction, or when a kit is not properly filled. Part availability failures can be triggered by inaccurate information about the location of the part or part shortage due to delays in internal logistics. Kit construction errors may be due to problems such as improper equipment setup, improper equipment maintenance, part damage, wrong type of part, or part dropped by the robot.


Models for detecting and recovering from plan execution failures mostly deal with \textit{precondition failures}, \textit{action failures}, and \textit{unattributable failures}~\cite{Myers1998}. Precondition failures appear when all the preconditions for an action are not met during the execution of the action. Action failures are encountered when the execution of an action does not attain its intended effects. Unattributable failures occur when unexpected events caused by external agents change the environment, thus causing the current plan to become obsolete. NIST\rq{}s Knowledge Driven Planning and Modeling project has not yet addressed the creation of a taxonomy of  execution errors. However, some preliminary metrics have been developed and are described
below.

\begin{itemize}
\item \sf Manipulation robustness \rm -- quantitative and qualitative functionality metrics that describe how well a robot can handle complex objects in complex environments without failing or requiring additional operator interventions. Failures can occur during object detection (lightning variation, shadows), object approach (partially buried), and object manipulation (fragile) operations.
It is envisioned that a taxonomy of robustness will be developed that decomposes robustness into areas such as situational awareness, robot accuracy, and grasping dexterity.\\

\item \sf Transporting components \rm -- qualitative metrics that describe how well a robotic arm can grasp objects and move these objects from an initial position to a goal position without dropping them.\\

\item \sf Plan generation \rm -- as mentioned previously, failures are possible in kitting during the execution of CRCL commands, causing the current plan to become obsolete. In some cases, the current state of the environment is brought back to the state prior to the failure and the robot starts from a ``stable" state. In other cases, a completely new plan must be generated by the planning system where the robot starts all over. This metric will measure the planning system\rq{}s ability to adapt to failures.\\

\item \sf Contact errors \rm -- quantitative metrics that keep track of the number of collisions between the robotic arm and objects in the environment. The performance of the robotic arm during kit building is affected by the positions of joints and the end-effector in the environment. The position of the end-effector can reduce the time to complete tasks but can also increase the number of collisions due to joint contact with other objects in a confined space.\\

\item \sf Failures during kit building\rm -- quantitative metrics that report the total number of failures encountered during kit building. When a failure occurs during the
building of a kit, the number of failures is increased by one. The system may generate a new plan to recover from the failure. If a failure occurs during the executio nof the new
plan, the number of failures in increased by one again.\\

\item \sf Failure modes recovery \rm -- quantitative metrics that represent the number of failure modes the system recovers from through the use of contingency plans. When a failure is detected in the execution process, failure monitors encode appropriate responses (contingency plans) to failure modes for this particular failure.\\

\end{itemize}
